I"n“<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<hr />

<h2 id="ç¬¬ä¸‰æ–¹åº“åœ¨vsä¸­çš„é…ç½®ä¸ä½¿ç”¨">ç¬¬ä¸‰æ–¹åº“åœ¨VSä¸­çš„é…ç½®ä¸ä½¿ç”¨</h2>

<p><a href="https://blog.csdn.net/MaybeTnT/article/details/109841378?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&amp;dist_request_id=1328602.40184.16150835415249919&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.control">æ•™ç¨‹</a></p>

<ol>
  <li>ä¸‹è½½åº“</li>
  <li>åœ¨åˆ›å»ºçš„å·¥ç¨‹ä¸­çš„è§£å†³æ–¹æ¡ˆçš„ä¸‹é¢ä¸€åˆ—å³å‡»é€‰æ‹©å±æ€§</li>
  <li>é€‰æ‹©<strong>æ‰€æœ‰å¹³å°</strong>ï¼Œ<strong>æ‰€æœ‰é…ç½®</strong></li>
  <li>é€‰æ‹©<strong>VC++ç›®å½•</strong>ï¼Œç‚¹å‡»<strong>åŒ…å«ç›®å½•</strong>æœ€åé¢ä¸‹æ‹‰ç®­å¤´çš„ç¼–è¾‘ï¼Œæ·»åŠ è·¯å¾„</li>
</ol>

<hr />

<h2 id="eigen3">eigen3</h2>

<h3 id="çŸ©é˜µå’Œå‘é‡çš„å®šä¹‰ä¸èµ‹å€¼">çŸ©é˜µå’Œå‘é‡çš„å®šä¹‰ä¸èµ‹å€¼</h3>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å®šä¹‰</span>
<span class="n">MatrixXd</span><span class="err">ï¼šå®šä¹‰ä»»æ„ç»´</span><span class="kt">double</span><span class="err">çŸ©é˜µã€‚å…¶ä¸­</span><span class="n">X</span><span class="err">è¡¨ç¤ºç»´åº¦ï¼Œ</span><span class="n">d</span><span class="err">è¡¨ç¤º</span><span class="kt">double</span><span class="err">å‹ã€‚åŒç†</span><span class="n">d</span><span class="err">å¯æ”¹ä¸º</span><span class="n">f</span><span class="err">æˆ–è€…</span><span class="n">i</span><span class="err">ï¼Œåˆ†åˆ«è¡¨ç¤º</span><span class="kt">float</span><span class="err">å‹ã€</span><span class="kt">int</span><span class="err">å‹ã€‚</span>
<span class="n">Matrix2d</span><span class="err">ï¼šå®šä¹‰</span><span class="mi">2</span><span class="err">ç»´</span><span class="kt">double</span><span class="err">çŸ©é˜µï¼ˆ</span><span class="mi">2</span><span class="err">Ã—</span><span class="mi">2</span><span class="err">ï¼‰</span>
<span class="n">Matrix3d</span><span class="err">ï¼šå®šä¹‰</span><span class="mi">3</span><span class="err">ç»´</span><span class="kt">double</span><span class="err">çŸ©é˜µï¼ˆ</span><span class="mi">3</span><span class="err">Ã—</span><span class="mi">3</span><span class="err">ï¼‰</span>
<span class="n">VectorXd</span> <span class="err">å®šä¹‰ä»»æ„ç»´</span><span class="kt">double</span><span class="err">å‘é‡</span>
<span class="n">Vector2d</span> <span class="err">å®šä¹‰</span><span class="mi">2</span><span class="err">ç»´</span><span class="kt">double</span><span class="err">å‘é‡ï¼ˆ</span><span class="mi">2</span><span class="err">Ã—</span><span class="mi">1</span><span class="err">ï¼‰</span>
<span class="n">Vector3d</span> <span class="err">å®šä¹‰</span><span class="mi">3</span><span class="err">ç»´</span><span class="kt">double</span><span class="err">å‘é‡ï¼ˆ</span><span class="mi">3</span><span class="err">Ã—</span><span class="mi">1</span><span class="err">ï¼‰</span>

<span class="n">MatrixXd</span> <span class="nf">temp1</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span> <span class="c1">//å®šä¹‰3*4çš„çŸ©é˜µ</span>
<span class="n">VectorXd</span> <span class="nf">temp2</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">//å®šä¹‰3ç»´è¡Œå‘é‡</span>
<span class="n">Vector3d</span> <span class="n">temp3</span><span class="p">;</span>       <span class="c1">//å®šä¹‰3ç»´è¡Œå‘é‡</span>
<span class="c1">//èµ‹å€¼</span>
<span class="n">temp1</span> <span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span>
	<span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span>
	<span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">;</span>
<span class="n">temp4</span> <span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">,</span>
	<span class="mi">1</span><span class="p">,</span>
	<span class="mi">1</span><span class="p">;</span>
<span class="c1">//ç‰¹æ®ŠçŸ©é˜µ/å‘é‡çš„èµ‹å€¼</span>
<span class="n">Matrix3d</span> <span class="n">temp1</span> <span class="o">=</span> <span class="n">MatrixXd</span><span class="o">::</span><span class="n">Identity</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>   <span class="c1">//å®šä¹‰3*3çš„å•ä½é˜µ</span>
<span class="n">Matrix3d</span> <span class="n">temp2</span> <span class="o">=</span> <span class="n">MatrixXd</span><span class="o">::</span><span class="n">Zero</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>       <span class="c1">//å®šä¹‰3*3çš„é›¶çŸ©é˜µ</span>
<span class="n">Matrix3d</span> <span class="n">temp3</span> <span class="o">=</span> <span class="n">MatrixXd</span><span class="o">::</span><span class="n">Ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>       <span class="c1">//å®šä¹‰3*3çš„å…¨1çŸ©é˜µ</span>
<span class="n">Vector3d</span> <span class="n">temp4</span> <span class="o">=</span> <span class="n">VectorXd</span><span class="o">::</span><span class="n">Zero</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>       <span class="c1">//å®šä¹‰3*1çš„é›¶å‘é‡</span>
<span class="n">Vector3d</span> <span class="n">temp5</span> <span class="o">=</span> <span class="n">VectorXd</span><span class="o">::</span><span class="n">Ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>       <span class="c1">//å®šä¹‰3*1çš„å…¨1å‘é‡</span>
</code></pre></div></div>

<h3 id="çŸ©é˜µåŸºæœ¬è®¡ç®—">çŸ©é˜µåŸºæœ¬è®¡ç®—</h3>

<p>å¸¸ç”¨çš„ â€œ+â€ï¼Œâ€œ-â€ï¼Œâ€œ*â€ï¼Œ â€œ/â€ ä¸ä¸€èˆ¬çš„æ“ä½œç›¸åŒã€‚</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">double</span> <span class="n">row</span> <span class="o">=</span> <span class="n">R</span><span class="p">.</span><span class="n">rows</span><span class="p">();</span>      <span class="c1">//rowä¸ºRçŸ©é˜µçš„è¡Œæ•°</span>
<span class="kt">double</span> <span class="n">col</span> <span class="o">=</span> <span class="n">R</span><span class="p">.</span><span class="n">cols</span><span class="p">();</span>      <span class="c1">//colä¸ºRçŸ©é˜µçš„åˆ—æ•°</span>
<span class="n">R</span><span class="p">.</span><span class="n">transpose</span><span class="p">();</span>               <span class="c1">//è½¬ç½®</span>
<span class="n">R</span><span class="p">.</span><span class="n">inverse</span><span class="p">();</span>                 <span class="c1">//é€†</span>
<span class="kt">double</span> <span class="n">d</span> <span class="o">=</span> <span class="n">R</span><span class="p">.</span><span class="n">determinant</span><span class="p">();</span>  <span class="c1">//è¡Œåˆ—å¼</span>
<span class="c1">//å‰ä¹˜</span>
<span class="n">Vector3d</span> <span class="nf">temp1</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">temp2</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">temp1</span><span class="p">.</span><span class="n">cross</span><span class="p">(</span><span class="n">temp2</span><span class="p">);</span>         <span class="c1">//temp1Ã—temp2</span>
<span class="c1">//SVDåˆ†è§£</span>
<span class="n">Matrix3d</span>  <span class="n">H</span><span class="p">;</span>
<span class="n">JacobiSVD</span><span class="o">&lt;</span><span class="n">Eigen</span><span class="o">::</span><span class="n">MatrixXd</span><span class="o">&gt;</span> <span class="n">svd</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">ComputeThinU</span> <span class="o">|</span> <span class="n">ComputeThinV</span><span class="p">);</span>
<span class="n">Matrix3d</span> <span class="n">V</span> <span class="o">=</span> <span class="n">svd</span><span class="p">.</span><span class="n">matrixV</span><span class="p">(),</span> <span class="n">U</span> <span class="o">=</span> <span class="n">svd</span><span class="p">.</span><span class="n">matrixU</span><span class="p">();</span>
<span class="n">Matrix3d</span> <span class="n">D</span> <span class="o">=</span> <span class="n">U</span><span class="p">.</span><span class="n">inverse</span><span class="p">()</span> <span class="o">*</span> <span class="n">H</span> <span class="o">*</span> <span class="n">V</span><span class="p">.</span><span class="n">transpose</span><span class="p">().</span><span class="n">inverse</span><span class="p">();</span> <span class="c1">// S = U^-1 * A * VT^ -1</span>
<span class="c1">//ç§©</span>
<span class="n">Matrix3d</span> <span class="n">D</span><span class="err">ï¼›</span>
<span class="n">FullPivLU</span><span class="o">&lt;</span><span class="n">Matrix3d</span><span class="o">&gt;</span> <span class="n">lu</span><span class="p">(</span><span class="n">D</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">lu</span><span class="p">.</span><span class="n">rank</span><span class="p">();</span>  
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"By default, the rank of A is found to be "</span> <span class="o">&lt;&lt;</span> <span class="n">lu</span><span class="p">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">lu</span><span class="p">.</span><span class="n">setThreshold</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"With threshold 1e-5, the rank of A is found to be "</span> <span class="o">&lt;&lt;</span> <span class="n">lu</span><span class="p">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="c1">//çŸ©é˜µå­å—çš„æå–</span>
<span class="n">MatrixXd</span> <span class="nf">temp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">temp</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
	<span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
	<span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">temp</span><span class="p">.</span><span class="n">block</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span> <span class="c1">//ä»çŸ©é˜µtempï¼ˆ0,0ï¼‰ä¸ºèµ·å§‹ç‚¹ï¼Œå–ä¸‰è¡Œä¸€åˆ—</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">temp</span><span class="p">.</span><span class="n">block</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span> <span class="c1">//ä»çŸ©é˜µtempï¼ˆ0,1ï¼‰ä¸ºèµ·å§‹ç‚¹ï¼Œå–ä¸‰è¡Œä¸€åˆ—</span>
<span class="c1">//è¾“å‡ºç»“æœä¸ºï¼š</span>
<span class="mi">0</span>
<span class="mi">2</span>
<span class="mi">4</span>
<span class="mi">1</span>
<span class="mi">3</span>
<span class="mi">5</span>
<span class="c1">//çŸ©é˜µæŒ‰è¡Œéå†</span>
<span class="n">MatrixXd</span> <span class="nf">R</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="n">R</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span>
     <span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span>
     <span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">;</span>
<span class="kt">double</span> <span class="n">row</span> <span class="o">=</span> <span class="n">R</span><span class="p">.</span><span class="n">rows</span><span class="p">();</span>      <span class="c1">//rowä¸ºRçŸ©é˜µçš„è¡Œæ•°</span>
<span class="kt">double</span> <span class="n">col</span> <span class="o">=</span> <span class="n">R</span><span class="p">.</span><span class="n">cols</span><span class="p">();</span>      <span class="c1">//colä¸ºRçŸ©é˜µçš„åˆ—æ•°</span>
<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">row</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">R</span><span class="p">.</span><span class="n">block</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">col</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">//æŒ‰åˆ—éå†</span>
<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">col</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">R</span><span class="p">.</span><span class="n">block</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="openmp">OpenMP</h2>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;omp.h&gt;
</span>
<span class="n">omp_get_num_procs</span><span class="p">()</span>       <span class="c1">//è·å¾—å¤„ç†å™¨ä¸ªæ•°</span>
<span class="n">omp_get_thread_num</span><span class="p">()</span>      <span class="c1">//æŸ¥çœ‹å½“å‰çº¿ç¨‹çš„idå·</span>
<span class="cp">#pragma omp parallel      //åˆ°æ‹¬å·ç»ˆæ­¢å¤„çš„éƒ¨åˆ†å°†ä¼šå¤šçº¿ç¨‹æ‰§è¡Œ
#pragma omp parallel for  //forå¾ªç¯ä¸­çš„å†…å®¹åˆ†å¼€äº¤ç»™å„ä¸ªçº¿ç¨‹å»å¤„ç†
</span><span class="c1">//sectionåŒºåŸŸåˆ†é…ï¼Œéœ€è¦æ‹¬å·</span>
<span class="cp">#pragma omp parallel sections
#pragma omp section
#pragma omp master        //åˆ’å®šçš„éƒ¨åˆ†å°†åªæœ‰ id = 0 çš„ä¸»çº¿ç¨‹æ‰§è¡Œ
#pragma omp barrier       //å…ˆæ‰§è¡Œå®Œæ¯•çš„çº¿ç¨‹ä¼šåœä¸‹ï¼Œç›´åˆ°æ‰€æœ‰çº¿ç¨‹éƒ½æ‰§è¡Œå®Œå†ç»§ç»­ï¼Œç”¨åœ¨ä¸€ä¸ªæ¨¡å—ç»“æŸå
</span></code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>g++ <span class="nt">-fopenmp</span> hello.cpp <span class="nt">-o</span> hello    ç¼–è¯‘ç¨‹åº
./hello                            è¿è¡Œ
</code></pre></div></div>

<hr />

<h2 id="å®å®šä¹‰">å®å®šä¹‰</h2>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define &lt;å®å&gt;ã€€ã€€&lt;å­—ç¬¦ä¸²&gt;
#define &lt;å®å&gt; (&lt;å‚æ•°è¡¨&gt;) &lt;å®ä½“&gt;
</span></code></pre></div></div>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// æŠŠå¤´æ–‡ä»¶å†…å®¹å…¨éƒ½æ”¾å…¥#ifndefå’Œ#endifä¸­ï¼Œé¿å…å¤šä¸ªæ–‡ä»¶éƒ½includeåŒä¸€å¤´æ–‡ä»¶ï¼Œç¼–è¯‘æˆä¸€ä¸ªå¯è¿è¡Œæ–‡ä»¶æ—¶å£°æ˜å†²çªã€‚ä¾‹å¦‚å¤´æ–‡ä»¶å†…int iå¯èƒ½å‡ºç°ié‡å¤å®šä¹‰çš„é”™è¯¯</span>
<span class="cp">#ifndef &lt;æ ‡è¯†&gt; 
#define &lt;æ ‡è¯†&gt; 
</span><span class="p">......</span> 
<span class="p">......</span> 
<span class="cp">#endif
</span></code></pre></div></div>

<hr />

<h2 id="txtäº¤äº’">txtäº¤äº’</h2>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//è¦†ç›–</span>
<span class="n">ofstream</span> <span class="nf">out</span><span class="p">(</span><span class="s">"/path/to/file"</span><span class="p">);</span>
<span class="n">out</span><span class="o">&lt;&lt;</span><span class="s">"write to file"</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="n">out</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
<span class="c1">//ä¸è¦†ç›–</span>
<span class="n">ofstream</span> <span class="nf">out</span><span class="p">(</span><span class="n">perf_count_path</span><span class="p">,</span><span class="n">ios</span><span class="o">::</span><span class="n">app</span><span class="p">);</span>
<span class="n">out</span><span class="o">&lt;&lt;</span><span class="s">"write to file"</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="n">out</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
</code></pre></div></div>

<hr />

<h2 id="avx">AVX</h2>

<h3 id="avxæ•°æ®ç±»å‹">AVXæ•°æ®ç±»å‹</h3>

<table>
  <thead>
    <tr>
      <th>æ•°æ®ç±»å‹</th>
      <th>æè¿°</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">__m128</code></td>
      <td>åŒ…å«4 <code class="language-plaintext highlighter-rouge">float</code>sçš„128ä½å‘é‡</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">__m128d</code></td>
      <td>åŒ…å«2 <code class="language-plaintext highlighter-rouge">double</code>sçš„128ä½å‘é‡</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">__m128i</code></td>
      <td>åŒ…å«æ•´æ•°çš„128ä½å‘é‡</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">__m256</code></td>
      <td>åŒ…å«8 <code class="language-plaintext highlighter-rouge">float</code>sçš„256ä½å‘é‡</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">__m256d</code></td>
      <td>åŒ…å«4 <code class="language-plaintext highlighter-rouge">double</code>sçš„256ä½å‘é‡</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">__m256i</code></td>
      <td>åŒ…å«æ•´æ•°çš„256ä½å‘é‡</td>
    </tr>
  </tbody>
</table>

<p>æ•´æ•°å‘é‡ç±»å‹å¯ä»¥åŒ…å«ä»<code class="language-plaintext highlighter-rouge">char</code>såˆ°<code class="language-plaintext highlighter-rouge">short</code>såˆ°<code class="language-plaintext highlighter-rouge">unsigned long long</code>sçš„ä»»ä½•æ•´æ•°ç±»å‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ª<code class="language-plaintext highlighter-rouge">_m256i</code>å¯ä»¥åŒ…å«32 <code class="language-plaintext highlighter-rouge">char</code>sï¼Œ16 <code class="language-plaintext highlighter-rouge">short</code>sï¼Œ8 <code class="language-plaintext highlighter-rouge">int</code>sæˆ–4 <code class="language-plaintext highlighter-rouge">long</code>sã€‚è¿™äº›æ•´æ•°å¯ä»¥å¸¦ç¬¦å·æˆ–æ— ç¬¦å·ã€‚</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">_mm</span><span class="o">&lt;</span><span class="n">bit_width</span><span class="o">&gt;</span><span class="n">_</span><span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">_</span><span class="o">&lt;</span><span class="n">data_type</span><span class="o">&gt;</span>
<span class="c1">//</span>
<span class="o">&lt;</span><span class="n">bit_width</span><span class="o">&gt;</span><span class="err">æ ‡è¯†å‡½æ•°è¿”å›çš„å‘é‡çš„å¤§å°ã€‚å¯¹äº</span><span class="mi">128</span><span class="err">ä½å‘é‡ï¼Œè¯¥å­—æ®µä¸ºç©ºã€‚å¯¹äº</span><span class="mi">256</span><span class="err">ä½å‘é‡ï¼Œæ­¤è®¾ç½®ä¸º</span> <span class="mi">256</span>
<span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="err">æè¿°å†…åœ¨å‡½æ•°æ‰§è¡Œçš„æ“ä½œ</span>
<span class="o">&lt;</span><span class="n">data_type</span><span class="o">&gt;</span> <span class="err">æ ‡è¯†å‡½æ•°ä¸»è¦å‚æ•°çš„æ•°æ®ç±»å‹</span>
<span class="c1">//</span>
<span class="err">æœ€åä¸€éƒ¨åˆ†</span><span class="o">&lt;</span><span class="n">data_type</span><span class="o">&gt;</span><span class="err">æœ‰ç‚¹å¤æ‚ã€‚å®ƒæ ‡è¯†è¾“å…¥å€¼çš„å†…å®¹ï¼Œå¹¶ä¸”å¯ä»¥è®¾ç½®ä¸ºä»¥ä¸‹ä»»ä½•å€¼ï¼š</span>
<span class="n">ps</span><span class="o">-</span><span class="err">å‘é‡åŒ…å«</span><span class="n">floats</span><span class="err">ï¼ˆ</span><span class="n">ps</span><span class="err">ä»£è¡¨å‹ç¼©å•ç²¾åº¦ï¼‰</span>
<span class="n">pd</span><span class="o">-</span><span class="err">å‘é‡åŒ…å«</span><span class="n">doubles</span><span class="err">ï¼ˆ</span><span class="n">pd</span><span class="err">ä»£è¡¨å‹ç¼©åŒç²¾åº¦ï¼‰</span>
<span class="n">epi8</span><span class="o">/</span><span class="n">epi16</span><span class="o">/</span><span class="n">epi32</span><span class="o">/</span><span class="n">epi64</span> <span class="o">-</span><span class="err">å‘é‡åŒ…å«</span><span class="mi">8</span><span class="err">ä½</span><span class="o">/</span> <span class="mi">16</span><span class="err">ä½</span><span class="o">/</span> <span class="mi">32</span><span class="err">ä½</span><span class="o">/</span> <span class="mi">64</span><span class="err">ä½æœ‰ç¬¦å·æ•´æ•°</span>
<span class="n">epu8</span><span class="o">/</span><span class="n">epu16</span><span class="o">/</span><span class="n">epu32</span><span class="o">/</span><span class="n">epu64</span> <span class="o">-</span><span class="err">å‘é‡åŒ…å«</span><span class="mi">8</span><span class="err">ä½</span><span class="o">/</span> <span class="mi">16</span><span class="err">ä½</span><span class="o">/</span> <span class="mi">32</span><span class="err">ä½</span><span class="o">/</span> <span class="mi">64</span><span class="err">ä½æ— ç¬¦å·æ•´æ•°</span>
<span class="n">si128</span><span class="o">/</span><span class="n">si256</span> <span class="o">-</span><span class="err">æœªæŒ‡å®šçš„</span><span class="mi">128</span><span class="err">ä½å‘é‡æˆ–</span><span class="mi">256</span><span class="err">ä½å‘é‡</span>
<span class="n">m128</span><span class="o">/</span><span class="n">m128i</span><span class="o">/</span><span class="n">m128d</span><span class="o">/</span><span class="n">m256</span><span class="o">/</span><span class="n">m256i</span><span class="o">/</span><span class="n">m256d</span> <span class="o">-</span><span class="err">å½“è¾“å…¥çš„å‘é‡ç±»å‹ä¸åŒäºè¿”å›çš„å‘é‡çš„ç±»å‹æ—¶ï¼Œæ ‡è¯†å®ƒä»¬</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>g++ studio.cpp <span class="nt">-mavx</span> <span class="nt">-o</span> studio <span class="c"># ç¼–è¯‘</span>

</code></pre></div></div>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;immintrin.h&gt;
#include &lt;iostream&gt;
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

  <span class="n">__attribute__</span> <span class="p">((</span><span class="n">aligned</span> <span class="p">(</span><span class="mi">32</span><span class="p">)))</span> <span class="kt">double</span> <span class="n">input1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">};</span>
  <span class="n">__attribute__</span> <span class="p">((</span><span class="n">aligned</span> <span class="p">(</span><span class="mi">32</span><span class="p">)))</span> <span class="kt">double</span> <span class="n">input2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">};</span>
  <span class="n">__attribute__</span> <span class="p">((</span><span class="n">aligned</span> <span class="p">(</span><span class="mi">32</span><span class="p">)))</span> <span class="kt">double</span> <span class="n">result</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>

  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"address of input1: "</span> <span class="o">&lt;&lt;</span> <span class="n">input1</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"address of input2: "</span> <span class="o">&lt;&lt;</span> <span class="n">input2</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

  <span class="n">__m256d</span> <span class="n">a</span> <span class="o">=</span> <span class="n">_mm256_load_pd</span><span class="p">(</span><span class="n">input1</span><span class="p">);</span>
  <span class="n">__m256d</span> <span class="n">b</span> <span class="o">=</span> <span class="n">_mm256_load_pd</span><span class="p">(</span><span class="n">input2</span><span class="p">);</span>
  <span class="n">__m256d</span> <span class="n">c</span> <span class="o">=</span> <span class="n">_mm256_add_pd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>

  <span class="n">_mm256_store_pd</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span>

  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">result</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h3 id="vector-apiè°ƒç”¨">Vector APIè°ƒç”¨</h3>
<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">double</span><span class="p">[]</span> <span class="n">add_serial</span><span class="p">(</span><span class="kt">double</span><span class="p">[]</span> <span class="n">a</span><span class="p">,</span> <span class="kt">double</span><span class="p">[]</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">double</span><span class="p">[]</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">double</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">c</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">double</span><span class="p">[]</span> <span class="n">add_vectorized</span><span class="p">(</span><span class="kt">double</span><span class="p">[]</span> <span class="n">a</span><span class="p">,</span> <span class="kt">double</span><span class="p">[]</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">double</span><span class="p">[]</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">double</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">DoubleVector</span> <span class="n">va</span> <span class="o">=</span> <span class="n">DoubleVector</span><span class="p">.</span><span class="n">fromArray</span><span class="p">(</span><span class="n">SPECIES</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="n">DoubleVector</span> <span class="n">vb</span> <span class="o">=</span> <span class="n">DoubleVector</span><span class="p">.</span><span class="n">fromArray</span><span class="p">(</span><span class="n">SPECIES</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="n">vc</span> <span class="o">=</span> <span class="n">va</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">vb</span><span class="p">);</span>
    <span class="n">vc</span><span class="p">.</span><span class="n">intoArray</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">c</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// fromArray å’Œ intoArray åˆ†åˆ«æ˜¯ä»ç»™å®šçš„å†…å­˜åœ°å€loadæ•°æ®åˆ°å‘é‡å¯„å­˜å™¨ä¸­ï¼Œä»¥åŠå°†æ•°æ®ä»å‘é‡å¯„å­˜å™¨ä¸­storeåˆ°ç»™å®šçš„å†…å­˜åœ°å€ã€‚SPECIESæè¿°äº†SIMDçš„ä½é•¿</span>
</code></pre></div></div>

<p><a href="https://enigmahuang.me/2017/09/29/AVX-SIMD/">ä¸€äº›å‚è€ƒ</a></p>

<ul>
  <li>å¿…é¡»æ˜¯æœ€å†…å±‚å¾ªç¯</li>
  <li>å¾ªç¯çš„é•¿åº¦æ˜¯ç¡®å®šçš„ï¼ˆå¦‚æœæ˜¯å›ºå®šçš„ä¼šæ›´å¥½ï¼‰</li>
  <li>å¾ªç¯ä½“å†…æ²¡æœ‰å˜é‡ä¾èµ–å…³ç³»</li>
  <li>å¾ªç¯è®¿é—®çš„æ•°æ®æ˜¯è¿ç»­çš„ï¼Œæˆ–è€…æœ€èµ·ç æ˜¯ç›¸åŒçš„æ­¥é•¿é—´éš”</li>
  <li>å¾ªç¯ä½“å†…æ²¡æœ‰å¤æ‚çš„åˆ†æ”¯åˆ¤æ–­ï¼›ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">if</code> æ˜¯å¯ä»¥æ¥å—çš„ï¼Œå› ä¸ºå¯ä»¥è¢«è½¬æ¢æˆ mask operation</li>
  <li>å¾ªç¯å†…æ²¡æœ‰è°ƒç”¨å…¶å®ƒå¤æ‚çš„å‡½æ•°ï¼›ç®€å•çš„å¯ä»¥è¢« inline çš„å‡½æ•°ä¸æ•°å­¦å‡½æ•°ä¾‹å¤–</li>
</ul>

<hr />

<h2 id="å…³äºc">å…³äºC</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">typedef</span><span class="err">ã€€</span><span class="kt">char</span><span class="o">*</span><span class="err">ã€€</span><span class="n">pstr</span><span class="p">;</span>
<span class="c1">// å…³äºMalloc</span>
<span class="kt">void</span> <span class="o">*</span><span class="nf">malloc</span><span class="p">(</span><span class="kt">int</span> <span class="n">size</span><span class="p">);</span>
<span class="n">malloc</span> <span class="err">å‘ç³»ç»Ÿç”³è¯·åˆ†é…æŒ‡å®š</span><span class="n">size</span><span class="err">ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ã€‚è¿”å›ç±»å‹æ˜¯</span> <span class="kt">void</span><span class="o">*</span> <span class="err">ç±»å‹ã€‚</span><span class="kt">void</span><span class="o">*</span> <span class="err">è¡¨ç¤ºæœªç¡®å®šç±»å‹çš„æŒ‡é’ˆã€‚</span>
<span class="kt">int</span><span class="o">*</span> <span class="n">p</span><span class="p">;</span><span class="err">ã€€</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span> <span class="n">malloc</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
</code></pre></div></div>

<hr />

<h2 id="å‘½åç©ºé—´">å‘½åç©ºé—´</h2>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// å®šä¹‰å‘½åç©ºé—´ï¼ˆå¯åµŒå¥—ï¼‰</span>
<span class="k">namespace</span> <span class="n">namespace_name1</span> <span class="p">{</span>
   <span class="c1">// ä»£ç å£°æ˜</span>
   <span class="k">namespace</span> <span class="n">namespace_name2</span> <span class="p">{</span>
      <span class="c1">// ä»£ç å£°æ˜</span>
   <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// è®¿é—® namespace_name2 ä¸­çš„æˆå‘˜</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">namespace_name1</span><span class="o">::</span><span class="n">namespace_name2</span><span class="p">;</span>
<span class="c1">// è®¿é—® namespace:name1 ä¸­çš„æˆå‘˜</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">namespace_name1</span><span class="p">;</span>
</code></pre></div></div>

<hr />

<h2 id="usingç”¨æ³•">usingç”¨æ³•</h2>

<ol>
  <li>å‘½åç©ºé—´çš„ä½¿ç”¨</li>
  <li>åœ¨å­ç±»ä¸­å¼•ç”¨åŸºç±»çš„æˆå‘˜</li>
  <li>åˆ«åæŒ‡å®š</li>
</ol>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">FP</span> <span class="o">=</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="å…³äºcmake">å…³äºcmake</h2>

<div class="language-cmake highlighter-rouge"><div class="highlight"><pre class="highlight"><code>add_library <span class="c1"># å°†æŒ‡å®šçš„æºæ–‡ä»¶ç”Ÿæˆé“¾æ¥æ–‡ä»¶ï¼Œç„¶åæ·»åŠ åˆ°å·¥ç¨‹ä¸­å»</span>
<span class="c1"># æŒ‡å®šè¦é“¾æ¥çš„åº“æ–‡ä»¶çš„è·¯å¾„</span>
<span class="nb">include_directories</span><span class="p">(</span>
include <span class="c1"># å¦‚æœæœ‰includeæ–‡ä»¶å¤¹çš„è¯ï¼Œå­˜æ”¾è‡ªå·±çš„å¤´æ–‡ä»¶</span>
<span class="p">)</span>
link_directories <span class="c1"># å°†ç›®æ ‡æ–‡ä»¶ä¸åº“æ–‡ä»¶è¿›è¡Œé“¾æ¥ï¼ŒçœŸæ­£é“¾æ¥æŸä¸€ä¸ªåº“</span>
</code></pre></div></div>

:ET