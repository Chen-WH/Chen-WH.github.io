---
layout:     post
title:      虚拟化技术
subtitle:   云计算技术4
date:       2021-10-16
author:     ChenWH 
header-img: img/ProseccoHills.jpg
catalog:   true
tags:

    - Cloud Computing
---

# 虚拟化技术

## 虚拟机中快照与克隆的区别

- 一个虚拟机的克隆就是原始虚拟机全部数据的一个拷贝，克隆的操作一但完成，克隆的虚拟机就可以脱离原始虚拟机独立存在，而且克隆的虚拟机和原始虚拟机完全独立，不共享任何资源。
- 虚拟机的快照指对某一个特定文件系统在某一个特定时间内的一个具有只读属性的镜像。快照时复制一份原磁盘的索引，指向的实际数据均为原始磁盘的数据，只有当原镜像的的数据发生变化时，才将变化区域的在变化之前的数据复制一份给快照对应位置。
- 快照和克隆都是某一时间点的镜像，区别在于快照只能读，而克隆可以写。快照仅能用于同一虚拟机不同时间点之间跳转，因为它保存的是原始磁盘数据的索引，有些类似git的commit操作；而虚拟机克隆储存了所有数据，可以进行新的部署。

## 全虚拟化、半虚拟化、硬件辅助虚拟化三者之间的区别。

- 全虚拟化：在执行特权指令时，会触发异常，然后 VMM 捕获这个异常，在异常里面做翻译，模拟，最后返回到客户操作系统内，客户操作系统认为自己的特权指令工作正常，继续运行。

- 半虚拟化：修改操作系统内核，替换掉不能虚拟化的指令，通过超级调用（hypercall）直接和底层的虚拟化层hypervisor来通讯，hypervisor 同时也提供了超级调用接口来满足其他关键内核操作，比如内存管理、中断和时间保持。

- 硬件辅助虚拟化：硬件层面直接分配给虚拟机物理设备，这样全虚拟化下，那些靠“捕获异常-翻译-模拟”的实现就不需要了。

  |        |             全虚拟化             |                           半虚拟化                           |                        硬件辅助虚拟化                        |
  | :----: | :------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
  | 兼容性 | 无需修改客户操作系统，最佳兼容性 | 客户操作系统需要修改来支持hypercall，兼容性差，不支持Windows |               无需修改客户操作系统，最佳兼容性               |
  |  性能  |                差                |                好，虚拟机的性能接近于物理机。                | CPU需要在两种模式之间切换，带来性能开销；但其性能在逐渐逼近半虚拟化。 |

  
